(function(e,t,n,r){t.each(["document","window"],function(t){window["$"+t]=e(window[t])}),n.registerHelpers(),t.isPlainObject=function(e){return t.isObject(e)&&!t.isFunction(e)&&!t.isArray()},window.app=window.Application=new r.Application,t.each(["Core","Util"],function(e){Application.module(e)})})(jQuery,_,Swag,Marionette),function(e){e.setup=function(t){function r(t,r){var s={h:$window.height(),w:$window.width()};if(!i(s))return;e.screenSize=s,e.config.fullScreen&&(n.height(s.h),n.width(s.w)),r||e.trigger("app:resized",s)}function i(e){return e.h>0&&e.w>0}function s(){var t=$window.scrollTop();e.trigger("app:scroll",t)}function u(t){t=_.compact(String(t).split("/"));if(t.length<=0)throw new Error("DEV::Application::Navigation path error");var n=t.shift();if(!n)throw new Error("DEV::Application::Empty context name...");var r=e.get(n,"Context");if(!r)throw new Error("DEV::Application::You must have the required context "+n+" defined...");if(!e.currentContext||e.currentContext.name!==n){var i=new r,s;i.guard&&(s=i.guard());if(s){e.trigger("app:context-guard-error",s,i.name);return}if(i.onBeforeNavigateTo&&!i.onBeforeNavigateTo()){e.trigger("app:navigation-aborted",i.name);return}e.currentContext&&e.currentContext.trigger("context:navigate-away"),e.Util.addMetaEvent(i,"context");var o=e.config.navRegion||e.config.contextRegion,u=e.mainView.getRegion(o)||e.getRegion(o);if(!u)throw new Error("DEV::Application::You don't have region '"+o+"' defined");i.once("show",function(){e.currentContext=i,e.trigger("app:context-switched",e.currentContext.name)}),u.show(i)}e.currentContext.trigger("context:navigate-chain",t)}if(e.config){_.extend(e.config,t);return}e.config=_.extend({theme:"default",template:"",contextRegion:"app",defaultContext:"Default",fullScreen:!1,rapidEventDelay:200,baseAjaxURI:"",viewTemplates:"static/template",viewSrcs:undefined,i18nResources:"static/resource",i18nTransFile:"i18n.json",i18nLocale:"",timeout:3e5},t),e.Util.addMetaEvent(e,"app");var n=$("body");$window.on("resize",_.debounce(r,e.config.rapidEventDelay)),e._ensureScreenSize=function(t){r(),e.screenSize?t():_.delay(e._ensureScreenSize,e.config.rapidEventDelay/4,t)},$window.on("scroll",_.throttle(s,e.config.rapidEventDelay)),e.config.fullScreen&&n.css({overflow:"hidden",margin:0,padding:0}),e.onAjax=function(t){e.config.baseAjaxURI&&(t.url=[e.config.baseAjaxURI,t.url].join("/"));var n=t.xdomain;n&&(t.url=(n.protocol||"http")+"://"+(n.host||"localhost")+(n.port&&":"+n.port||"")+(/^\//.test(t.url)?t.url:"/"+t.url),t.crossDomain=!0,t.xhrFields=_.extend(t.xhrFields||{},{withCredentials:!0}),t.headers=_.extend(t.headers||{},n.headers))};var o=e.uri(window.location.toString()).search(!0).theme||e.config.theme;return o&&(e.inject.css("themes/"+o+"/css/main.css",$("#theme-roller")[0]),e.currentTheme=o),e.config.viewTemplates&&e.inject.tpl("all.json"),I18N.configure({locale:e.config.i18nLocale,resourcePath:e.config.i18nResources,translationFile:e.config.i18nTransFile}),e.onNavigate=function(t,n){if(!e.available()){e.trigger("app:blocked",t);return}var r="";_.isString(t)?r=t:r=_.string.rtrim([t.context||e.currentContext.name,t.module||t.subpath].join("/"),"/"),n||e.hybridEvent?u(r):window.location.hash="navigate/"+r},e.onContextGuardError=function(e,t){console.error("DEV:Context-Guard-Error:",t,e)},e.on("initialize:after",function(t){var n=Backbone.Marionette.AppRouter.extend({appRoutes:{"navigate/*path":"navigateTo"},controller:{navigateTo:function(t){e.navigate(t||e.config.defaultContext,!0)}}});e.router=new n,Backbone.history&&Backbone.history.start(),window.location.hash||(e.get(e.config.defaultContext,"Context")?e.navigate(e.config.defaultContext):console.warn("DEV::Application::You might want to define a Default context using app.context('Context Name', {...})"))}),e},e.run=function(t){function n(){Modernizr.mobile&&FastClick.attach(document.body),e.addRegions({app:'[region="app"]'}),e.trigger("app:before-mainview-ready"),e.mainView=e.mainView||e.view({template:e.config.template},!0),e.getRegion("app").show(e.mainView),e.trigger("app:mainview-ready"),e._ensureScreenSize(function(){e.start()})}return t=t===!0?"deviceready":t,t?(e.hybridEvent=t,window.onerror=function(t,n,r){e.trigger("app:error",{errorMsg:t,target:n,lineNum:r})},e.onError=function(e,t,n){console.error(e,t,n)},document.addEventListener("touchmove",function(e){e.target.classList.contains("scrollable")||e.preventDefault()},!1),document.addEventListener(t,function(){$document.ready(n)},!1)):$document.ready(n),e}}(Application),function(e){e.create=function(t,n){console.warn("DEV::Application::create() method is deprecated, use methods listed in ",e._apis," for alternatives")},_.extend(e,{view:function(t,n){if(_.isString(t)){if(_.isBoolean(n)&&n)return e.Core.Regional.create(t);if(_.isPlainObject(n))return e.Core.Regional.register(t,n)}if(_.isPlainObject(t)){var r=n;n=t;var i=n.name?e.Core.Regional.register(n):Backbone.Marionette[n.type||"Layout"].extend(n);return _.isBoolean(r)&&r?new i:i}return e.Core.Regional.get(t)},context:function(t,n){if(!n){if(_.isString(t)||!t)return e.Core.Context.get(t);n=t}else _.extend(n,{name:t});return e.Core.Context.register(n)},widget:function(t,n){return n?_.isFunction(n)?e.Core.Widget.register(t,n):e.Core.Widget.create(t,n):e.Core.Widget.get(t)},editor:function(t,n){return n?_.isFunction(n)?e.Core.Editor.register(t,n):e.Core.Editor.create(t,n):e.Core.Editor.get(t)},regional:function(t,n){return n=n||{},_.isString(t)?_.extend(n,{name:t}):_.extend(n,t),console.warn("DEV::Application::regional() method is deprecated, use .view() instead for",n.name),e.view(n,!n.name)},has:function(t,n){return n?e.Core[n]&&e.Core[n].has(t):(_.each(["Context","Regional","Widget","Editor"],function(r){!n&&e.Core[r].has(t)&&(n=r)}),n)},get:function(t,n,r){if(!t)return{Context:e.Core.Context.get(),View:e.Core.Regional.get(),Widget:e.Core.Widget.get(),Editor:e.Core.Editor.get()};var i;_.each(["Context","Regional","Widget","Editor"],function(r){i||(i=e.Core[n||r].get(t))});if(i)return i;if(r)throw new Error("Application::get() Double check your view name defined in "+e.nameToPath(t)+" for "+e.pathToName(t));return e.config&&e.config.viewSrcs&&$.ajax({url:_.compact([e.config.viewSrcs,e.nameToPath(t)]).join("/")+".js",dataType:"script",async:!1}).done(function(){i=!0}).fail(function(e,n,r){throw new Error("DEV::Application::get() Can NOT load View definition for",t,"[",r,"]")}),i===!0?this.get(t,n,!0):i},coop:function(t,n){return e.trigger("app:coop",t,n),e.trigger("app:coop-"+t,n),e},pathToName:function(e){if(!_.isString(e))throw new Error("DEV::Application::pathToName You must pass in a valid path string.");return _.contains(e,".")?e:e.split("/").map(_.string.humanize).map(_.string.classify).join(".")},nameToPath:function(e){if(!_.isString(e))throw new Error("DEV::Application::nameToPath You must pass in a Reusable view name.");return _.contains(e,"/")?e:e.split(".").map(_.str.humanize).map(_.str.slugify).join("/")},navigate:function(t,n){return e.trigger("app:navigate",t||e.config.defaultContext,n)},lock:function(t){return e.Core.Lock.lock(t)},unlock:function(t){return e.Core.Lock.unlock(t)},available:function(t){return e.Core.Lock.available(t)},remote:function(t){return t=t||{},t.payload?e.Core.Remote.change(t):e.Core.Remote.get(t)},download:function(t){return e.Util.download(t)},inject:{js:function(){return e.Util.inject.apply(null,arguments)},tpl:function(){return e.Util.Tpl.remote.load.apply(e.Util.Tpl.remote,arguments)},css:function(){return loadCSS.apply(null,arguments)}},model:function(e){return new Backbone.Model(e)},collection:function(e){return new Backbone.Collection(e)},extract:function(e,t){return selectn(e,t)},cookie:Cookies,store:store.enabled&&store,validator:validator,moment:moment,uri:URI}),e.editor.validator=e.editor.rule=function(t,n){if(!_.isString(t))throw new Error("DEV::Validator:: You must specify a validator/rule name to use.");return e.Core.Editor.addRule(t,n)},e.page=e.context,e.area=e.regional,e._apis=["model","collection","context - @alias:page","regional - @alias:area","view","widget","editor","editor.validator - @alias:editor.rule","remote","lock","unlock","available","download","create - @deprecated"],e.ADE="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend"}(Application),function(e){e.Util.addMetaEvent=function(e,t,n){n||(n=e),e.listenTo(e,"all",function(r){var i=String(r).split(":");if(i.length!==2||i[0]!==t)return;var s=_.string.camelize("on-"+i[1]);n[s]&&n[s].apply(e,_.toArray(arguments).slice(1))})}}(Application),function(e){function t(t){var n=$("#hidden-download-iframe");n.length>0||($("body").append('<iframe id="hidden-download-iframe" style="display:none"></iframe>'),n=$("#hidden-download-iframe")),_.isString(t)&&(t={url:t}),n.attr("src",e.uri(t.url||"/").addQuery(_.omit(t,"url")).toString())}e.Util.download=t}(Application),function(e){var t=/[\.\/]/,n={normalizeId:function(e){return String(e).split(t).join("-")},cache:Backbone.Marionette.TemplateCache,build:function(e,t){arguments.length===1&&(t=e,e=null);var n=_.isArray(t)?t.join(""):t;if(e){var r=this.normalizeId(e),i=$('head > script[id="'+r+'"]');i.length>0?(i.html(n),this.cache.clear("#"+e),console.log("DEV::APP.Util.Template::",e,"overriden")):$("head").append(['<script type="text/tpl" id="',r,'">',n,"</script>"].join(""))}return n},remote:{map:{},load:function(t,r){var i=this,s=(r||e.config.viewTemplates)+"/"+t;if(!_.string.endsWith(t,".json")){var o="";return $.ajax({url:s,dataType:"html",async:!1}).done(function(e){i.map[t]&&(n.cache.clear("@"+t),console.log("DEV::APP.Util.Template::",t,"overriden")),o=i.map[t]=e}).fail(function(){throw new Error("DEV::View Template:: Can not load template..."+s+", re-check your app.config.viewTemplates setting")}),o}$.ajax({url:s,dataType:"json",async:!1}).done(function(e){_.each(e,function(e,t){i.map[t]&&(n.cache.clear("@"+t),console.log("DEV::APP.Util.Template::",t,"overriden")),i.map[t]=e})})},get:function(e){return e?this.map[e]:_.keys(this.map)}}};e.Util.Tpl=n}(Application),function(e){e.Util.inject=function(t){t=t||"patch.json",_.string.endsWith(t,".js")?($.getScript(t),e.trigger("app:script-injected",t)):$.getJSON(t).done(function(t){var n="";_.isArray(t)||(n=t.base,t=t.list),_.each(t,function(t){e.Util.inject((_.string.endsWith(n,"/")?n:n?n+"/":"")+t)})})}}(Application),function(e,t,n){function i(n){if(!n)throw new Error("DEV::Core.Remote::options empty, you need to pass in at least a url string");if(t.isString(n))n={url:n,timeout:e.config.timeout,type:"GET"};else{t.extend(n,{type:undefined,data:undefined,processData:!1,contentType:"application/json; charset=UTF-8",dataType:"json",timeout:e.config.timeout});if(n.entity){var r=n.entity;n.url=r}n.payload&&n.payload._id&&(n._id&&console.warn("DEV::Core.Remote::options.payload._id",n.payload._id,"overriding options._id",n._id),n._id=n.payload._id);if(n._id||n._method){var i=e.uri(n.url);n.url=i.path(t.compact([i.path(),n._id,n._method]).join("/")).toString()}n.params=n.querys||n.params,n.params&&(n.url=e.uri(n.url).search(n.params).toString())}return e.trigger("app:ajax",n),n}var r=e.module("Core.Remote");t.extend(r,{get:function(t){return t=i(t),t.type="GET",e.trigger("app:remote-pre-get",t),n.ajax(t)},change:function(r){r=i(r);if(!r.payload)throw new Error("DEV::Core.Remote::payload empty, please use GET");return r.payload._id&&t.size(r.payload)===1?r.type="DELETE":(t.isObject(r.payload)||(r.payload={payload:r.payload}),r.payload._id?r.type="PUT":r.type="POST"),r.type!=="DELETE"&&(r.data=JSON.stringify(r.payload)),e.trigger("app:remote-pre-change",r),n.ajax(r)}}),$document.ajaxSend(function(t,n,r){e.trigger("app:ajax-start",t,n,r)}),$document.ajaxComplete(function(t,n,r){e.trigger("app:ajax-stop",t,n,r)}),$document.ajaxSuccess(function(t,n,r,i){e.trigger("app:ajax-success",t,n,r,i)}),$document.ajaxError(function(t,n,r,i){e.trigger("app:ajax-error",t,n,r,i)}),$document.ajaxStart(function(){e.trigger("app:ajax-active")}),$document.ajaxStop(function(){e.trigger("app:ajax-inactive")}),e.ajaxFailed=function(e,t,n){throw new Error("DEV::Ajax::"+n+" "+t.url)}}(Application,_,jQuery),function(e){var t=e.module("Core.Lock"),n={},r=!1;_.extend(t,{create:function(e,t){if(!_.isString(e)||!e)throw new Error("DEV::Core.Lock::You must give this lock a name/topic ...");return n[e]?!1:(t=_.isNumber(t)?t||1:1,n[e]={current:t,allowance:t},!0)},get:function(e){return!e||e==="*"?{global:r,locks:n}:n[e]},lock:function(e){return r?!1:!e||e==="*"?r?!1:(r=!0,!0):_.isUndefined(n[e])?(this.create(e,1),this.lock(e)):n[e].current>0?(n[e].current--,!0):!1},unlock:function(e){!e||e==="*"?r&&(r=!1):_.isUndefined(n[e])||n[e].current<n[e].allowance&&n[e].current++},available:function(e){if(r)return!1;if(!e||e==="*")return r===!1;var t=this.get(e);return t?t.current>0:!0}})}(Application),function(e,t,n){function r(r){r=e.string.classify(r);var i=t.module("Core."+r);return e.extend(i,{map:{},has:function(n){if(!e.isString(n)||!n)throw new Error("DEV::Reusable:: You must specify the name of the "+r+" to look for.");return n=t.pathToName(n),this.map[n]?n:undefined},register:function(i,s){var o;e.isPlainObject(i)?(o=i,i=o.name,e.extend(o,{className:r.toLowerCase()+" "+e.string.slugify(r+"-"+o.name)+" "+(o.className||""),category:r}),s=function(){return n[o.type||"Layout"].extend(o)}):e.isPlainObject(s)&&(o=e.extend({name:i},s),s=function(){return n[o.type||"Layout"].extend(o)});if(!e.isString(i)||!i)throw new Error("DEV::Reusable:: You must specify a "+r+" name to register.");if(!e.isFunction(s))throw new Error("DEV::Reusable:: You must specify a "+r+" factory function to register "+i+" !");return this.has(i)&&console.warn("DEV::Overriden::Reusable "+r+"."+i),this.map[i]=s(),this.map[i].prototype.name=i,t.trigger("app:reusable-registered",this.map[i],r),t.coop("reusable-registered",this.map[i],r),this.map[i]},create:function(t,n){if(!e.isString(t)||!t)throw new Error("DEV::Reusable:: You must specify the name of the "+r+" to create.");var i=this.get(t);if(i)return new i(n||{});throw new Error("DEV::Reusable:: Required definition ["+t+"] in "+r+" not found...")},get:function(t){if(!t)return e.keys(this.map);t=this.has(t);if(t)return this.map[t]},alter:function(e,t){var n=this.get(e);if(n)return n=n.extend(t),n;throw new Error("DEV::Reusable:: Required definition ["+e+"] in "+r+" not found...")}}),i}r("Context"),r("Regional"),r("Widget"),r("Editor")}(_,Application,Marionette),function(e){Backbone.Marionette.TemplateCache.prototype.loadTemplate=function(t){if(_.string.startsWith(t,"#"))return $(t).html();if(_.string.startsWith(t,"@")){var n=t.substr(1),r=e.Util.Tpl.remote.get(n);return r?r:e.Util.Tpl.remote.load(n)}return e.Util.Tpl.build(t)},Backbone.Marionette.TemplateCache.prototype.compileTemplate=function(e){return Handlebars.compile(e)}}(Application),function(e){_.extend(Backbone.Marionette.Region.prototype,{show:function(t,n){this.ensureEl();var r=this.currentView;if(r){var i=(_.isPlainObject(r.effect)?r.effect.exit:r.effect?r.effect+"Out":"")||(this.$el.data("effect")?this.$el.data("effect")+"Out":"")||this.$el.data("effectExit");if(i){var s=this;return r.$el.addClass(i).addClass("animated").one(e.ADE,function(){s.close(),s._show(t,n)}),this}this.close()}return this._show(t,n)},_show:function(e,t){return e.render(),Marionette.triggerMethod.call(this,"before:show",e),_.isFunction(e.triggerMethod)?e.triggerMethod("before:show"):Marionette.triggerMethod.call(e,"before:show"),this.open(e),this.currentView=e,Marionette.triggerMethod.call(this,"show",e),_.isFunction(e.triggerMethod)?e.triggerMethod("show"):Marionette.triggerMethod.call(e,"show"),this},open:function(t){var n=(_.isPlainObject(t.effect)?t.effect.enter:t.effect?t.effect+"In":"")||(this.$el.data("effect")?this.$el.data("effect")+"In":"")||this.$el.data("effectEnter");if(n){t.$el.css("opacity",0).addClass(n);function r(){_.defer(function(){t.$el.addClass("animated").one(e.ADE,function(){t.$el.removeClass("animated",n)}),_.defer(function(){t.$el.css("opacity",1)})})}t.once("show",function(){r()})}this.$el.empty().append(t.el),this._parentLayout&&(t.parentCt=this._parentLayout,this._parentLayout.category==="Context"?t.parentCtx=this._parentLayout:this._parentLayout.parentCtx&&(t.parentCtx=this._parentLayout.parentCtx)),t.fieldset&&(this._parentLayout._fieldsets=this._parentLayout._fieldsets||{},this._parentLayout._fieldsets[t.fieldset]=t);if(this._contentStyle){var i=this;_.defer(function(){t.trigger("view:resized",{region:i})})}return t.parentRegion=this,this},resize:function(e){e=e||{},this._contentStyle=_.extend({},e,this._contentOverflow),this.$el.css(this._contentStyle);var t=this;return _.defer(function(){t.currentView&&t.currentView.trigger("view:resized",{region:t})}),this}})}(Application),function(e){_.extend(Backbone.Marionette.View.prototype,{isInDOM:function(){return this.$el?$.contains(document.documentElement,this.$el[0]):!1}}),Backbone.Marionette.View.prototype.constructor=function(t){return t=t||{},(this.type||t.type)&&console.warn("DEV::View::type is deprecated, please do not specify "+(this.name?"in "+this.name:"")),this.template=t.template||this.template||" ",this._ui=_.extend({},this.ui,t.ui),this.listenTo(this,"render",function(){var e=this;this.unbindUIElements(),this.ui=this._ui,$(this.el.outerHTML).find("[ui]").each(function(t,n){var r=$(this).attr("ui");e.ui[r]='[ui="'+r+'"]'}),this.bindUIElements()}),e.Util.addMetaEvent(this,"view"),this.coop&&(this._postman={},_.each(this.coop,function(t){var n=this;this._postman[t]=function(r){n.trigger("view:"+t,r),n.isInDOM()||e.off("app:coop-"+t,n._postman[t])},e.on("app:coop-"+t,this._postman[t])},this),this.listenTo(this,"close",function(){_.each(this._postman,function(t,n){e.off("app:coop-"+n,t)})})),this.data&&(_.isString(this.data)?this.listenToOnce(this,"before:render",this.refresh):_.isArray(this.data)?this.set("items",this.data):_isPlainObject(this.data)&&this.set(this.data)),this.actions&&this.enableActionTags&&this.enableActionTags(this.actions._bubble),this.editors&&this.activateEditors&&this.listenTo(this,"render",function(){this.activateEditors(this.editors)}),this.svg&&this.enableSVG&&this.listenTo(this,"render",this.enableSVG),this.tooltips&&this.enableTooltips&&this.enableTooltips(this.tooltips),this.overlay&&this.enableOverlay&&this.enableOverlay(),I18N.locale&&this.listenTo(this,"render",function(){this.$el.i18n({search:!0})}),Backbone.Marionette.View.apply(this,arguments)}}(Application),function(e){_.extend(Backbone.Marionette.ItemView.prototype,{enableActionTags:function(t,n){_.isBoolean(t)&&(n=t,t=""),n=n||!1,this.events=this.events||{},_.extend(this.events,{"click [action]":"_doAction"}),this.actions=this.actions||{},t=t||this.name||"UNKNOWN.View",this._doAction=function(r){var i=$(r.currentTarget),s=i.attr("action")||"UNKNOWN",o=i.attr("lock"),u=i.attr("unlock");u&&e.unlock(u);if(o&&!e.lock(o)){r.stopPropagation(),r.preventDefault(),e.trigger("app:blocked",s,o);return}if(i.hasClass("disabled")||i.parent().hasClass("disabled")){r.stopPropagation(),r.preventDefault();return}var a=String(s).split(":");if(a.length>=2)return a.shift(),r.stopPropagation(),this.trigger(a.join(":"));var f=this.actions[s];if(!f){if(n)return;throw r.stopPropagation(),new Error("DEV::"+(t||"UI Component")+"::You have not yet implemented this action - ["+s+"]")}r.stopPropagation(),f.apply(this,[i,r,o])}}}),_.extend(Backbone.Marionette.ItemView.prototype,{enableSVG:function(){if(!Raphael)throw new Error("DEV::View::You did NOT have Raphael.js included...");var e=this;Raphael(this.el,this.$el.width(),this.$el.height(),function(){e.paper=this,e.trigger("view:paper-ready",this)}),this.onFitPaper=function(){if(!this.paper)return;this.paper.setSize(this.$el.width(),this.$el.height()),this.trigger("view:paper-resized")}}}),_.extend(Backbone.Marionette.ItemView.prototype,{activateEditors:function(t){this._editors=this._editors||{};if(this._editors.attachView)throw new Error("DEV::ItemView::activateEditors enhancements will need this._editors object, it is now a Region!");var n=t._global||{};_.each(t,function(t,r){if(r.match(/^_./))return;var i,s;_.isFunction(t)?(i=t,t=_.extend({},n),s=new i,s.name=r,s.isCompound=!0):(t=_.extend({name:r,parentCt:this},n,t),t.label||(t.className=t.className||" "),t.type=t.type||"text",i=e.Core.Editor.map[t.type]||e.Core.Editor.map.Basic,s=new i(t)),this._editors[r]=s.render();var o=this.$('[editor="'+r+'"]');o.length===0&&t.appendTo&&(o=this.$(t.appendTo)),o.length===0&&(o=this.$el),o.append(s.el),t.value&&s.setVal(t.value)},this),this.listenTo(this,"before:close",function(){_.each(this._editors,function(e){e.close()})});var r=_.pick(this,"getEditor","getValues","setValues","validate","status");this.getEditor=function(e){return this._editors[e]||r.getEditor&&r.getEditor.call(this,e)},this.getValues=function(){var e=r.getValues&&r.getValues.call(this)||{};return _.each(this._editors,function(t,n){var r=t.getVal();r!==undefined&&r!==null&&(e[n]=r)}),e},this.setValues=function(e,t){if(!e)return;_.each(this._editors,function(n,r){e[r]!==null&&e[r]!==undefined&&n.setVal(e[r],t)}),r.setValues&&r.setValues.call(this,e,t)},this.validate=function(e){var t=r.validate&&r.validate.call(this,e)||{};_.each(this._editors,function(n,r){var i;this.isCompound?i=n.validate():i=n.validate(e),i&&(t[r]=i)},this),this.isCompound&&e&&this.status(t);if(_.size(t)===0)return;return t},this.status=function(e){if(_.isString(e))throw new Error("DEV::ItemView::activateEditors - You need to pass in messages object instead of "+e);r.status&&r.status.call(this,e);if(!e||_.isEmpty(e)){_.each(this._editors,function(e,t){e.status()});return}_.each(e,function(e,t){this._editors[t]&&this._editors[t].status(e)},this)}}}),_.extend(Backbone.Marionette.ItemView.prototype,{enableTooltips:function(e){this.listenTo(this,"render",function(){this.$('[data-toggle="tooltip"]').tooltip(e)})}}),_.extend(Backbone.Marionette.ItemView.prototype,{enableOverlay:function(){this._overlayConfig=_.isBoolean(this.overlay)?{}:this.overlay,this.overlay=function(e){e=e||{};var t=$(e.anchor||"body"),n=this;return this.listenTo(this,"close",function(){t.overlay()}),t.overlay(_.extend(this._overlayConfig,e,{content:function(){return n.render().el},onShow:function(){n.triggerMethod("show")},onClose:function(){n.close()}})),this}}}),_.extend(Backbone.Marionette.ItemView.prototype,{set:function(){return this.model||(this.model=new Backbone.Model),!this._oneWayBinded&&this.isInDOM()&&(this.listenTo(this.model,"change",this.render),this._oneWayBinded=!0),this.model.set.apply(this.model,arguments)},get:function(){if(!this.model)throw new Error("DEV::ItemView:: You have not yet setup data in this view");return arguments.length?this.model.get.apply(this.model,arguments):this.model.toJSON()},refresh:function(){if(!_.isString(this.data)){console.log("DEV::ItemView::refresh Define a url data configure or override this method...");return}var t=this;e.remote(this.data).done(function(e){t.trigger("view:render-data",e)}).fail(e.ajaxFailed)},onRenderData:function(e){_.isArray(e)?this.set("items",e):this.set(e),this.trigger("view:data-rendered")}})}(Application),function(e){_.extend(Backbone.Marionette.Layout.prototype,{getValues:function(){var e={};return this.regionManager.each(function(t){t.currentView&&t.currentView.getValues&&(t.currentView.fieldset?e[t.currentView.fieldset]=t.currentView.getValues():_.extend(e,t.currentView.getValues()))}),e},setValues:function(e,t){this.regionManager.each(function(n){n.currentView&&n.currentView.setValues&&(n.currentView.fieldset?n.currentView.setValues(e[n.currentView.fieldset],t):n.currentView.setValues(e,t))})},validate:function(e){var t={};this.regionManager.each(function(n){n.currentView&&n.currentView.validate&&(n.currentView.fieldset?t[n.currentView.fieldset]=n.currentView.validate(e):_.extend(t,n.currentView.validate(e)))});if(_.size(t)===0)return;return t},getEditor:function(e){if(!e||_.isEmpty(e))return;_.isArray(e)||(e=String(e).split("."));var t=e.shift();if(this._fieldsets&&this._fieldsets[t])return this._fieldsets[t].getEditor(e.join("."));return},status:function(e){this.regionManager.each(function(t){t.currentView&&t.currentView.status&&(!e||!t.currentView.fieldset?t.currentView.status(e):t.currentView.status(e[t.currentView.fieldset]))})}});var t=Backbone.Marionette.Layout;Backbone.Marionette.Layout=t.extend({constructor:function(n){n=n||{},this.regions=_.extend({},this.regions,n.regions),this.listenTo(this,"render",function(){var e=this;$(this.el.outerHTML).find("[region]").each(function(t,n){var r=$(n).attr("region");e.regions[r]={selector:'[region="'+r+'"]'}}),this.addRegions(this.regions),_.each(this.regions,function(e,t){this[t].ensureEl(),this[t].$el.addClass("region region-"+_.string.slugify(t)),this[t]._parentLayout=this,this[t]._contentOverflow={},_.each(["overflowX","overflowY","overflow"],function(e){var n=this[t].$el.data(e);n&&(this[t]._contentOverflow[e]=n)},this)},this)}),this.listenTo(this,"render",function(){_.each(this.regions,function(t,n){this[n].listenTo(this[n],"region:load-view",function(t,n){if(!t)return;if(_.string.startsWith(t,"@")){this.show(e.view({template:t},!0));return}var r=e.get(t);if(r){this.show(new r(n));return}console.warn("DEV::Layout::View required "+t+" can NOT be found...use app.view({name: ..., ...}).")})},this)}),this.listenTo(this,"show",function(){_.each(this.regions,function(e,t){this.debug&&this[t].$el.html('<p class="alert alert-info">Region <strong>'+t+"</strong></p>"),this[t].trigger("region:load-view",this[t].$el.attr("view"))},this),this.trigger("view:all-region-shown")});if(n.name||this.name)this.navRegion=n.navRegion||this.navRegion,this.onNavigateChain=function(t){if(!t||t.length===0){this.trigger("view:navigate-to");return}if(!this.navRegion)return this.trigger("view:navigate-to",t.join("/"));if(!this.regions[this.navRegion]){console.warn("DEV::Layout::View","invalid navRegion",this.navRegion,"in",this.name||n.name);return}var r=t.shift(),i=e.get(r);if(!i)return t.unshift(r),this.trigger("view:navigate-to",t.join("/"));var s=this.getRegion(this.navRegion);if(!s.currentView||i.prototype.name!==s.currentView.name){var o=new i;s.currentView&&s.currentView.trigger("view:navigate-away"),o.once("show",function(){o.trigger("view:navigate-chain",t)}),s.show(o);return}s.currentView.trigger("view:navigate-chain",t)};return t.prototype.constructor.call(this,n)}})}(Application),function(e){_.extend(Backbone.Marionette.CollectionView.prototype,{onRenderData:function(e){if(!_.isArray(e))throw new Error("DEV::CollectionView+::You need to have an array passed in as data...");this.collection||(this.collection=new Backbone.Collection,this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render)),this.collection.reset(e),this.trigger("view:data-rendered")},onLoadPage:function(t){t=_.extend({page:1,pageSize:15,dataKey:"payload",totalKey:"total",params:{}},this._remote,t),_.each(["params","querys"],function(e){if(!t[e])return;_.extend(t[e],{offset:(t.page-1)*t.pageSize,size:t.pageSize})});var n=this;this._remote=t,e.remote(_.omit(t,"page","pageSize","dataKey","totalKey")).done(function(){n.trigger("view:load-page-done",arguments)}).fail(function(){n.trigger("view:load-page-fail",arguments)}).always(function(){n.trigger("view:load-page-always",arguments)})},onLoadPageDone:function(e){var t=e[0];this.trigger("view:render-data",t[this._remote.dataKey]),this.trigger("view:page-changed",{current:this._remote.page,total:Math.ceil(t[this._remote.totalKey]/this._remote.pageSize)})}})}(Application);var I18N={};(function(e,t){function s(e){function r(e){n.push("## module: "),n.push(e),n.push(" ##"),n.push("\n")}function s(e,t){e=String(e),t=String(t),n.push('"'),n.push(e.replace(/"/g,'\\"')),n.push('"'),n.push("="),n.push(t),n.push("\n")}var n=[];t.each(i,function(n,i){if(e&&!n)return;typeof n=="object"?t.each(n,function(e,t){t!=="_default"&&r(t),s(i,e)}):s(i,n)});var o=n.join("");return o}function o(e){var n=i;return e&&(n=t.reject(i,function(e,t){return e?!0:!1})),JSON.stringify({locale:r,trans:n})}function u(t,n){var r=e(n),i=r.data("i18nKey"),s=r.data("i18nModule");i==="*"&&(i=e.trim(r.html())),r.html(i.i18n({module:s})),r.removeAttr("data-i18n-key")}var n={resourcePath:"static/resource",translationFile:"i18n.json"},r,i;I18N.configure=function(s){t.extend(n,s);var o=app.uri(window.location.toString()).search(!0);return r=I18N.locale=o.locale||n.locale||Detectizr.browser.language,r&&(e.ajax({url:[n.resourcePath,n.translationFile.indexOf("{locale}")>=0?n.translationFile.replace("{locale}",r):[r,n.translationFile].join("/")].join("/"),async:!1,dataType:"json",success:function(e,t,n){if(!e||!e.trans)throw new Error("RUNTIME::i18n::Malformed "+r+" data...");i=e.trans},error:function(e,t,n){throw new Error("RUNTIME::i18n::"+n)}}),i=i||{}),this},String.prototype.i18n=function(t){var n=e.trim(this);if(!r||!n)return n;var s=i[n];if(typeof s=="undefined")return i[n]="",n;if(typeof s=="object"){var o=t&&t.module||"_default";s=s[o];if(typeof s=="undefined")return i[n][o]="",n}return s=String(s),s.trim()===""?n:s},I18N.getResourceProperties=s,I18N.getResourceJSON=o,Handlebars&&Handlebars.registerHelper("i18n",function(e,n,r){return r||(r=n,n=undefined),t.isString(e)?e.i18n(n&&{module:n}):t.isUndefined(e)?"":e}),e.fn.i18n=function(e){return e=t.extend({search:!1},e),e.search?(this.find("[data-i18n-key]").each(u),this):this.filter("[data-i18n-key]").each(u)}})(jQuery,_),function(e){function t(e,t){var n=window.hljs;n&&(n.configure(t&&t.hljs),e.find("pre code").each(function(){n.highlightBlock(this)}))}e.fn.md=function(n){var r=this;return _.isString(n)&&(n={url:n}),n=n||{},n.marked=_.extend({gfm:!0,tables:!0,breaks:!1},n.marked),this.each(function(r,i){var s=e(i),o=s.data(),u=n.url||o.url;e.get(u).done(function(e){var r;r=marked(e,n.marked),_.defer(function(){s.html(r).addClass("md-content"),t(s,n),n.cb&&n.cb(s)})})})}}(jQuery),function(e){function r(n,r){r=_.extend({ignoreRoot:!1,headerHTML:""},r);var i=[],s=e("<div></div>").append(r.headerHTML).append("<ul></ul>");s.$children=s.find("> ul").data("children",[]);var o=s,u=r.ignoreRoot?1:0;n.find((r.ignoreRoot?"":"h1,")+"h2,h3,h4,h5,h6").each(function(){var n=e(this),r=n.context.localName,s=n.html(),a=n.attr("id");i.push(n);var f=e('<li><a href="#" data-id="'+a+'" action="goTo">'+s+"</a><ul></ul></li>");f.data({title:s,id:a});switch(r){case"h2":case"H2":f.addClass("chapter");break;case"h3":case"H3":f.addClass("section");break;default:}f.$children=f.find("> ul").data("children",[]);var l=t[r]-u;if(l>0)f.$parent=o,o.$children.append(f).data("children").push(f),u++;else if(l===0)f.$parent=o.$parent,o.$parent.$children.append(f).data("children").push(f);else{while(l<0)l++,o=o.$parent,u--;f.$parent=o.$parent,o.$parent.$children.append(f).data("children").push(f)}o=f,n.data("toc-node",f)}),n.data("toc",{html:'<div class="md-toc">'+s.html()+"</div>",$headers:i})}var t={};for(var n=1;n<=6;n++)t["h"+n]=t["H"+n]=n;e.fn.toc=function(t){return this.each(function(n,i){var s=e(i);r(s,t)})}}(jQuery),function(e){var t=Handlebars.compile(['<div class="overlay {{class}}" style="position:absolute; top: 0; left: 0; right: 0; bottom: 0; {{#unless class}}z-index:{{zIndex}};background:{{background}};{{/unless}}">','<div class="overlay-outer" style="display: table;table-layout: fixed; height: 100%; width: 100%;">','<div class="overlay-inner" style="display: table-cell;text-align: center;vertical-align: middle; width: 100%;">','<div class="overlay-content-ct" style="display: inline-block;outline: medium none; position:relative;">',"</div>","</div>","</div>","</div>"].join(""));e.fn.overlay=function(n,r){return _.isObject(n)&&(r=n,n=!0),_.isUndefined(n)&&(n=!1),r=r||{},this.each(function(i,s){var o=e(this),u;if(!n){if(!o.data("overlay"))return;u=o.data("overlay"),r=_.extend({},u.data("closeOptions"),r),u.hide({effect:r.closeEffect||r.effect||"clip",complete:function(){r.onClose&&r.onClose(o,u),$window.off("resize",u.data("onResize")),u.remove();var e=o.data("recover-css");o.css({overflowY:e.overflow.y,overflowX:e.overflow.x,position:e.position}),o.removeData("overlay","recover-css")}})}else{if(o.data("overlay"))return;r=_.extend({zIndex:100,background:r.content?"rgba(0, 0, 0, 0.7)":"none",move:!1,resize:!1},r),u=e(t(r)),o.data("recover-css",{overflow:{x:o.css("overflowX"),y:o.css("overflowY")},position:o.css("position")}),o.append(u).css({position:"relative",overflow:"hidden"}),o[0].tagName==="BODY"&&(u.offset({top:$window.scrollTop()}),u.height($window.height()),u.data("onResize",function(){u.height($window.height())}),$window.on("resize",u.data("onResize"))),u.hide(),o.data("overlay",u),$container=u.find(".overlay-content-ct"),r.resize&&$container.resizable({containment:"parent"}),r.move&&$container.draggable({containment:"parent"}),u.data({closeOptions:_.pick(r,"closeEffect","effect","duration","onClose"),container:$container}),u.data("container").html(_.isFunction(r.content)?r.content(o,u):r.content),u.show({effect:r.openEffect||r.effect||"clip",complete:function(){r.onShow&&r.onShow(o,u)}})}})}}(jQuery),function(e){e.Core.Editor.register("Basic",function(){var t=Backbone.Marionette.ItemView.extend({template:"#editor-basic-tpl",className:"form-group",events:{change:"_triggerEvent","keyup input, textarea":"_triggerEvent",focusout:"_triggerEvent",focusin:"_triggerEvent"},initialize:function(t){this.parentCt=t.parentCt;if(t.type in{select:!0,radios:!0,checkboxes:!0}){switch(t.type){case"radios":t.type="radio";break;case"checkboxes":t.type="checkbox";break;default:}t.options=t.options||{},t.options=_.extend({data:[],valueField:"value",labelField:"label"},t.options);var n=t.options,r=function(e){return _.isObject(e[0])?e=_.map(e,function(e){return{value:e[n.valueField],label:e[n.labelField]}}):e=_.map(e,function(e){return{value:e,label:_.string.titleize(e)}}),e},i=function(e){return _.isArray(e.data)||(e.grouped=!0),e.grouped?_.each(e.data,function(t,n){e.data[n]=r(t)}):e.data=r(e.data),e};n.remote?this.listenToOnce(this,"render",function(){var t=this;e.remote(n.remote).done(function(e){t.setChoices(e)})}):i(t.options),this.setChoices=function(e){var t=this.model.get("options");t.data=e,this.model.set("options",i(t)),this.render()}}var s=_.uniqueId("basic-editor-");this.model=new Backbone.Model({uiId:s,layout:t.layout||"",name:t.name,type:t.type,multiple:t.multiple||!1,rows:t.rows||3,fieldname:t.fieldname||s,label:t.label||"",placeholder:t.placeholder||"",help:t.help||"",tooltip:_.isString(t.tooltip)&&t.tooltip||"",options:t.options||undefined,boxLabel:t.boxLabel||"",value:t.value,checked:t.checked||!0,unchecked:t.unchecked||!1}),t.validate&&(this.validators=_.map(t.validate,function(e,t){return _.isFunction(e)?{fn:e}:{rule:t,options:e}}),this.validate=function(n){if(!this.isEnabled())return;var r;if(_.isFunction(t.validate))r=t.validate(this.getVal(),this.parentCt);else{var i=_.clone(this.validators);while(i.length>0){var s=i.shift();s.fn?r=s.fn(this.getVal(),this.parentCt):r=e.Core.Editor.rules[s.rule]&&e.Core.Editor.rules[s.rule](s.options,this.getVal(),this.parentCt);if(!_.isEmpty(r))break}}return n&&this._followup(r),r},this._followup=function(e){_.isEmpty(e)?(this.status(),this.eagerValidation=!1):(this.status(e),this.eagerValidation=!0)},this.listenTo(this,"editor:change editor:keyup",function(){this.eagerValidation&&this.validate(!0)})),t.tooltip&&this.enableTooltips(_.isObject(t.tooltip)?t.tooltip:{});if(t.type==="file"){this.enableActionTags("Editor.File");if(!t.upload||!t.upload.url)throw new Error("DEV::Editor.Basic.File::You need options.upload.url to point to where to upload the file.");this.listenTo(this,"editor:change",function(){this.ui.input.val()?(t.upload.standalone&&this.ui.upload.removeClass("hidden").show(),this.ui.clearfile.removeClass("hidden").show()):(this.ui.upload.hide(),this.ui.clearfile.hide())}),this.onRender=function(){this.$el.fileupload({fileInput:null}),t.upload.callbacks&&_.each(t.upload.callbacks,function(e,t){this.$el.bind("fileupload"+t,_.bind(e,this))},this)},_.extend(this.actions,{clear:function(){this.setVal("",!0)},upload:function(){var e=this;this.upload(_.extend({success:function(t){e.ui.result.html(_.isString(t)?t.i18n():JSON.stringify(t)),_.delay(function(){e.ui.result.empty()},6e3)}},t.upload))}}),this.upload=function(n){n=_.extend({},t.upload,n),n.formData&&(n.formData=_.result(n,"formData")),e.config.baseAjaxURI&&(n.url=[e.config.baseAjaxURI,n.url].join("/")),this.$el.fileupload("send",_.extend({timeout:e.config.timeout*2,fileInput:this.ui.input},n))}}},isEnabled:function(){return!this._inactive},disable:function(e){e===!1?this._inactive=!1:this._inactive=!0;if(_.isUndefined(e)){this.ui.input&&this.ui.input.prop("disabled",!0);return}e?this.$el.hide():(this.ui.input&&this.ui.input.prop("disabled",!1),this.$el.show())},setVal:function(e,t){this.ui.inputs?this.ui.inputs.find("input").val(_.isArray(e)?e:[e]):this.ui["input-ro"]?(e=_.escape(e),this.ui["input-ro"].data("value",e).html(e)):(this.model.get("type")==="checkbox"&&this.ui.input.prop("checked",e===this.model.get("checked")),this.ui.input.val(e)),t&&this._triggerEvent({type:"change"})},getVal:function(){if(!this.isEnabled())return;if(this.ui.inputs){var e=this.$("input:checked").map(function(e,t){return $(this).val()}).get();return this.model.get("type")==="radio"&&(e=e.pop()),e}if(this.model.get("type")==="checkbox")return this.ui.input.prop("checked")?this.model.get("checked")||!0:this.model.get("unchecked")||!1;if(this.ui.input)return this.ui.input.val()},validate:$.noop,status:function(e){if(e){var t="error",n=e;_.isString(e)||(t=e.type||t,n=e.msg||t);var r="has-"+t;this.$el.removeClass(this.$el.data("type-class")).addClass(r).data("type-class",r),this.ui.msg.html(n.i18n())}else this.$el.removeClass(this.$el.data("type-class")).removeData("type-class"),this.ui.msg.empty()},_triggerEvent:function(e){var t=this;t.trigger("editor:"+e.type,this.model.get("name"),this),this.parentCt&&(t=this.parentCt),t.trigger("editor:"+e.type,this.model.get("name"),this)}});return t}),e.Util.Tpl.build("editor-basic-tpl",["{{#if label}}",'<label class="control-label {{#if layout}}{{layout.label}}{{/if}}" for="{{uiId}}">{{i18n label}}</label>',"{{/if}}",'<div class="{{#if layout}}{{layout.field}}{{/if}}" data-toggle="tooltip" title="{{i18n tooltip}}">','{{#is type "select"}}','<select ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" class="form-control" id="{{uiId}}" {{#if multiple}}multiple="multiple"{{/if}} style="margin-bottom:0">',"{{#if options.grouped}}","{{#each options.data}}",'<optgroup label="{{i18n @key}}">',"{{#each this}}",'<option value="{{value}}">{{i18n label}}</option>',"{{/each}}","</optgroup>","{{/each}}","{{else}}","{{#each options.data}}",'<option value="{{value}}">{{i18n label}}</option>',"{{/each}}","{{/if}}","</select>","{{else}}",'{{#is type "textarea"}}','<textarea ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" class="form-control" id="{{uiId}}" rows="{{rows}}" placeholder="{{i18n placeholder}}" style="margin-bottom:0"></textarea>',"{{else}}","{{#if options}}",'<div ui="inputs" id={{uiId}}>',"{{#each options.data}}",'{{#unless ../options.inline}}<div class="{{../../type}}">{{/unless}}','<label class="{{#if ../options.inline}}{{../../type}}-inline{{/if}}">','<input ui="input" name="{{#if ../fieldname}}{{../../fieldname}}{{else}}{{../../name}}{{/if}}{{#is ../type "checkbox"}}[]{{/is}}" type="{{../type}}" value={{value}}> {{i18n label}}',"</label>","{{#unless ../options.inline}}</div>{{/unless}}","{{/each}}","</div>","{{else}}",'<div class="{{type}}">','{{#is type "checkbox"}}',"<label>",'<input ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" type="checkbox" value="{{value}}"> {{i18n boxLabel}}',"</label>","{{else}}",'{{#is type "ro"}}','<div ui="input-ro" data-value="{{{value}}}" class="form-control-static">{{value}}</div>',"{{else}}",'<input ui="input" name="{{#if fieldname}}{{fieldname}}{{else}}{{name}}{{/if}}" {{#isnt type "file"}}class="form-control"{{else}} style="display:inline;" {{/isnt}} type="{{type}}" id="{{uiId}}" placeholder="{{i18n placeholder}}" value="{{value}}"> <!--1 space-->','{{#is type "file"}}','<span action="upload" class="hidden file-upload-action-trigger" ui="upload" style="cursor:pointer;"><i class="glyphicon glyphicon-upload"></i> <!--1 space--></span>','<span action="clear" class="hidden file-upload-action-trigger" ui="clearfile"  style="cursor:pointer;"><i class="glyphicon glyphicon-remove-circle"></i></span>','<span ui="result" class="file-upload-result wrapper-horizontal"></span>',"{{/is}}","{{/is}}","{{/is}}","</div>","{{/if}}","{{/is}}","{{/is}}",'{{#if help}}<span class="help-block editor-help-text" style="margin-bottom:0"><small>{{i18n help}}</small></span>{{/if}}','<span class="help-block editor-status-text input-error" ui="msg">{{i18n msg}}</span>',"</div>"])}(Application),function(e){e.Core.Editor.rules={required:function(e,t,n){if(!t)return _.isObject(e)&&e.msg||"This field is required"}},e.Core.Editor.addRule=function(t,n){if(!t||!_.isFunction(n))throw new Error("DEV::Editor::Basic validation rule must have a name and a function implementation.");e.Core.Editor.rules[t]&&console.warn("DEV::Editor::Basic validation rule name ["+t+"] is already defined."),e.Core.Editor.rules[t]=n}}(Application),function(e){e.widget("Datagrid",function(){var t=e.view({type:"Layout",tagName:"table",template:['<thead region="header"></thead>','<tbody region="body"></tbody>'],initialize:function(e){this._options=_.extend({data:[],details:!1,columns:[]},e)},onShow:function(){this.header.show(new n),this.body.show(new i({el:this.body.$el})),this.trigger("view:reconfigure",this._options)},onReconfigure:function(e){e=e||{},this._options.data=e.data||this._options.data,_.each(this._options.columns,function(e){e.header=e.header||"string",e.cell=e.cell||e.header||"string",e.label=e.label||_.string.titleize(e.name)}),this.header.currentView.trigger("view:render-data",this._options.columns),this.body.currentView._options=this._options,this.body.currentView.trigger("view:render-data",this._options.data),this.trigger("view:data-rendered")},onRenderData:function(e){this.trigger("view:reconfigure",{data:e})},getBody:function(){return this.body.currentView},getHeader:function(){return this.header.currentView}}),n=e.view({type:"CollectionView",itemView:"dynamic",itemViewEventPrefix:"headercell",tagName:"tr",initialize:function(e){this.grid=this.parentCt||e&&e.grid},buildItemView:function(t,n,r){return e.widget(_.string.classify([t.get("header"),"header","cell"].join("-")),{model:t,tagName:"th",row:this})}}),r=e.view({type:"CollectionView",itemView:"dynamic",itemViewEventPrefix:"cell",tagName:"tr",triggers:{click:{event:"clicked",preventDefault:!1},dblclick:{event:"dblclicked",preventDefault:!1}},initialize:function(e){this.grid=e.body.parentCt},buildItemView:function(t,n,r){return e.widget(_.string.classify([t.get("cell"),"cell"].join("-")),{tagName:"td",model:t,row:this})}}),i=e.view({type:"CollectionView",itemView:r,itemViewEventPrefix:"row",itemViewOptions:function(t,n){return{collection:e.collection(_.map(this._options.columns,function(r){return _.extend({value:e.extract(r.name||"",t.attributes),index:n},r)},this)),body:this}},itemEvents:{clicked:function(e,t){t.grid.trigger("row:clicked",t)},dblclicked:function(e,t){t.grid.trigger("row:dblclicked",t)}}});return t})}(Application),function(e){e.widget("StringHeaderCell",function(){var t=e.view({template:'<span><i class="{{icon}}"></i> {{{i18n label}}}</span>'});return t})}(Application),function(e){e.widget("StringCell",function(){var t=e.view({template:"<span>{{{value}}}</span>"});return t})}(Application),function(e){e.widget("SeqCell",function(){var t=e.view({template:"{{index}}"});return t})}(Application),function(e){e.widget("ActionCell",function(){var t=e.view({template:["{{#each actions}}",'<span class="action-cell-item" action="{{@key}}" data-toggle="tooltip" title="{{i18n tooltip}}"><i class="{{icon}}"></i> {{i18n label}}</span> ',"{{/each}}"],className:"action-cell",initialize:function(e){this.row=e.row;var t=this.model.get("actions")||{};_.each({preview:{icon:"fa fa-eye",tooltip:"Preview"},edit:{icon:"fa fa-pencil",tooltip:"Edit"},"delete":{icon:"fa fa-times",tooltip:"Delete"}},function(e,n){t[n]&&(t[n]=_.extend(e,t[n]))}),this.actions=this.actions||{},_.each(t,function(e,t){e.fn&&(this.actions[t]=function(t){e.fn.apply(this.row,arguments)})},this),this.model.set("actions",t),this.enableActionTags(!0)},tooltips:!0});return t})}(Application),function(e){e.widget("Tree",function(){var t={type:"CompositeView",tagName:"li",itemViewContainer:"ul",itemViewOptions:function(){return{parent:this}},className:function(){return _.size(this.model.get("children"))>=1?"node":"leaf"},initialize:function(t){this.parent=t.parent,this.className()==="node"&&(this.collection=e.collection(this.model.get("children"))),this.listenTo(this,"render",function(){this.$el.addClass("clickable").data({view:this,$children:this.$el.find("> ul"),$parent:this.parent&&this.parent.$el})})},template:['<a class="item" href="#"><i class="type-indicator"></i> <i class="{{icon}}"></i> {{{i18n val}}}</a>','<ul class="children hidden"></ul>']},n=e.view({type:"CollectionView",className:"tree tree-root",tagName:"ul",initialize:function(n){this._options=n,this.itemView=this._options.itemView||e.view(_.extend({},t,_.omit(this._options.node,"type","tagName","itemViewContainer","itemViewOptions","className","initialize"))),this.onSelected=n.onSelected||this.onSelected},onShow:function(){this.trigger("view:reconfigure",this._options)},onReconfigure:function(e){_.extend(this._options,e),this.trigger("view:render-data",this._options.data)},events:{"click .clickable":function(e){e.stopPropagation();var t=$(e.currentTarget),n=t.data();t.hasClass("node")&&this.trigger("view:toggleChildren",n),this.trigger("view:selected",t.data(),t,e)}},onToggleChildren:function(e){e.$children.toggleClass("hidden"),e.view.$el.toggleClass("expanded")},onSelected:function(e,t,n){}});return n})}(Application),function(e){e.widget("Paginator",function(){var t=e.view({className:"pagination",tagName:"ul",template:['<li {{#if atFirstPage}}class="disabled"{{/if}}><a href="#" action="goToFirstPage" data-page="--">'+_.escape("<<")+"</a></li>",'<li {{#if atFirstWindow}}class="hidden"{{/if}}><a href="#" action="goToAdjacentWindow" data-window="-">...</a></li>',"{{#each pages}}",'<li {{#if isCurrent}}class="active"{{/if}}><a href="#" action="goToPage" data-page="{{number}}">{{number}} <span class="sr-only">(current)</span></a></li>',"{{/each}}",'<li {{#if atLastWindow}}class="hidden"{{/if}}><a href="#" action="goToAdjacentWindow" data-window="+">...</a></li>','<li {{#if atLastPage}}class="disabled"{{/if}}><a href="#" action="goToLastPage" data-page="++">'+_.escape(">>")+"</a></li>"],initialize:function(e){this._options=_.extend({pageWindowSize:5},e),e.target&&this.listenTo(e.target,"view:page-changed",function(e){this.trigger("view:reconfigure",{currentPage:e.current,totalPages:e.total})})},onShow:function(){},onReconfigure:function(e){_.extend(this._options,e),this._options.currentWindow=Math.ceil(this._options.currentPage/this._options.pageWindowSize);var t={atFirstPage:this._options.currentPage===1,atLastPage:this._options.currentPage===this._options.totalPages,atFirstWindow:this._options.currentWindow===1,atLastWindow:this._options.currentWindow===Math.ceil(this._options.totalPages/this._options.pageWindowSize),pages:_.reduce(_.range(1,this._options.totalPages+1),function(e,t){return t>(this._options.currentWindow-1)*this._options.pageWindowSize&&t<=this._options.currentWindow*this._options.pageWindowSize&&e.push({number:t,isCurrent:t===this._options.currentPage}),e},[],this)};this.trigger("view:render-data",t)},actions:{goToPage:function(e,t){t.preventDefault();var n=e.data("page");if(n===this._options.currentPage)return;this.trigger("view:change-page",n)},goToFirstPage:function(e,t){t.preventDefault(),this.trigger("view:change-page",1)},goToLastPage:function(e,t){t.preventDefault(),this.trigger("view:change-page",this._options.totalPages)},goToAdjacentWindow:function(e,t){t.preventDefault();var n=this._options.currentWindow,r=e.data("window");r==="+"?n++:n--;if(n<1||n>Math.ceil(this._options.totalPages/this._options.pageWindowSize))return;this.trigger("view:change-page",n==1?1:(n-1)*this._options.pageWindowSize+1)}},onChangePage:function(e){this._options.target&&this._options.target.trigger("view:load-page",{page:e})}});return t})}(Application),app.stagejs="1.8.2-866 build 1439932023088";